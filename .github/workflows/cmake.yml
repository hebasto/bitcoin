# Copyright (c) 2023-present The Bitcoin Core developers
# Distributed under the MIT software license, see the accompanying
# file COPYING or https://opensource.org/license/mit/.

name: CMake
on:
  # Running for pushes is enough in the cmake-staging branch.
  # pull_request:
  push:
    branches:
      - '**'
    tags-ignore:
      - '**'

concurrency:
  group: ${{ github.workflow }}${{ github.event_name != 'pull_request' && github.run_id || github.ref }}
  cancel-in-progress: true

jobs:
  solaris:
    name: 'Solaris, no depends, sqlite only, no gui'
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4

    - uses: vmactions/solaris-vm@v1
      with:
        prepare: |
          uname -a
          pkg install cmake boost-libs libevent pkgconf sqlite3 libzmq4 python3
        run: |
          cmake -B build
        copyback: false
